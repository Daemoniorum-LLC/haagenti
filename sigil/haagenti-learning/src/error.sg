//! Error types ∀ continuous learning

invoke thiserror·Error;

/// Learning errors
//@ rune: derive(Debug, Error)
☉ ᛈ LearningError {
    /// Adapter error
    //@ rune: error("Adapter error: {0}")
    AdapterError(String),

    /// Buffer error
    //@ rune: error("Buffer error: {0}")
    BufferError(String),

    /// Training error
    //@ rune: error("Training error: {0}")
    TrainingError(String),

    /// Gradient error
    //@ rune: error("Gradient error: {0}")
    GradientError(String),

    /// Checkpoint error
    //@ rune: error("Checkpoint error: {0}")
    CheckpointError(String),

    /// Shape mismatch
    //@ rune: error("Shape mismatch: expected {expected:?}, got {got:?}")
    ShapeMismatch {
        expected: Vec<usize>,
        got: Vec<usize>,
    },

    /// Configuration error
    //@ rune: error("Configuration error: {0}")
    ConfigError(String),

    /// IO error
    //@ rune: error("IO error: {0}")
    IoError(#[from] std·io·Error),
}

/// Result type ∀ learning operations
☉ type Result<T> = std·result·Result<T, LearningError>;
